<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8">
  <title>–ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞–ª—ã“õ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è ‚Äî —Ç–µ—Å—Ç, —Ç–∞“õ—Ç–∞, –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root{--card:#fff;--bg:#e6f9fc;--muted:#166534;--accent:#0ea5e9;--danger:#ef4444;--good:#22c55e;}
    body{margin:0;background:var(--bg);font-family:sans-serif;}
    .container{max-width:1120px;margin:0 auto;padding:20px 12px 65px;}
    header{display:flex;justify-content:space-between;align-items:flex-start;gap:14px;margin-bottom:18px;padding:13px 15px;background:var(--card);box-shadow:0 1px 15px #38bdf844;border-radius:17px;}
    @media(max-width:990px){header{flex-direction:column;}}
    .title h1{margin:0 0 6px;font-size:21px;color:var(--accent);}
    .title p{margin:1px 0 6px 0;color:var(--muted);font-size:13px;}
    .badge-row{display:flex;gap:8px;margin-bottom:5px;}
    .badge{padding:5px 8px;border-radius:99px;background:#bae6fd;color:#075985;font-size:12px;}
    nav a{font-size:13px;color:var(--accent);margin-right:10px;}
    .timer-box{min-width:200px;padding:9px 13px;background:var(--accent);color:#fff;border-radius:14px;box-shadow:0 0 18px #0ea5e91b;}
    .timer-time{font-size:25px;font-weight:900;}
    .timer-status{font-size:13px;}
    main{display:grid;grid-template-columns: 1.06fr 0.94fr;gap:14px;align-items:flex-start;}
    @media(max-width:980px){main{grid-template-columns:1fr;}}
    .card{background:var(--card);border-radius:16px;padding:14px 20px;margin-bottom:17px;box-shadow:0 2px 13px #0ea5e924;}
    h2{margin-top:0;}
    h3{margin-top:15px;}
    .formula{background:#bae6fd;border-radius:999px;padding:4px 11px;font-size:13px;font-weight:700;color:#0ea5e9;}
    .ex{background:#f0fdfa;padding:9px 13px 10px 17px;border-radius:10px;font-size:13px;}
    ul{font-size:14px;}
    .board{background:#f8fafc;padding:10px 9px 15px;border-radius:14px;margin-bottom:13px;}
    .tools{display:flex;gap:7px;align-items:center;}
    .tools .tool{padding:5px 9px;border-radius:9px;background:#bae6fd;font-size:13px;font-weight:700;}
    canvas{width:100%;height:170px;border-radius:12px;background:#f0fdfa;border:1px solid #bae6fd;}
    .calc{background:#f0fdfa;padding:11px 13px 13px;border-radius:12px;}
    .calc input,.calc select{padding:7px 11px;border-radius:9px;border:1px solid #bae6fd;margin-bottom:7px;}
    .calc .out{background:var(--accent);color:#fff;padding:7px 9px;border-radius:7px;margin-top:4px;font-size:13px;}
    .question{margin-bottom:12px;padding:9px 11px;background:#f0fdfa;border-radius:11px;}
    .question-title{font-weight:700;margin-bottom:6px;}
    label.option{display:block;font-size:13px;margin-bottom:3px;}
    .small-feedback{font-size:12px;margin-top:3px;}
    .small-feedback.correct{color:var(--good);}
    .small-feedback.wrong{color:var(--danger);}
    .test-result{padding:8px 12px;border-radius:10px;background:#d1fae5;font-size:13px;margin:8px 0;}
    .match-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
    .match-item{padding:7px 10px;border-radius:7px;background:#ecfeff;margin:5px 0;}
    .match-item input{width:38px;border-radius:6px;}
    .save-box{margin-top:10px;padding:7px 11px;border-radius:10px;background:#f0fdfa;display:flex;gap:7px;align-items:center;}
    .save-box input{padding:6px 10px;font-size:13px;border-radius:999px;border:1px solid #bae6fd;min-width:130px;}
    .saved-table{width:100%;border-collapse:collapse;margin-top:7px;font-size:12px;}
    .saved-table th,.saved-table td{border:1px solid #d1fae5;padding:4px 6px;}
    .saved-table th{background:#bae6fd;}
    .chip{padding:5px 8px;border-radius:99px;background:#b7e7f7;font-size:12px;}
    footer{margin-top:16px;}
  </style>
</head>
<body>
<div class="container">
  <header>
    <div class="title">
      <h1>–ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞–ª—ã“õ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è ‚Äî —Ç–µ—Å—Ç, —Ç–∞“õ—Ç–∞, –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h1>
      <p>a‚Çô, d, S‚Çô, –Ω–µ–≥—ñ–∑–≥—ñ —Ñ–æ—Ä–º—É–ª–∞–ª–∞—Ä, 10 –±–∞–ª–ª–¥—ã“õ —Ç–µ—Å—Ç, —Ç–∞“õ—Ç–∞ –∂”ô–Ω–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä.</p>
      <div class="badge-row">
        <span class="badge">8‚Äì9 —Å—ã–Ω—ã–ø</span>
        <span class="badge">a‚Çô, d, S‚Çô</span>
        <span class="badge">15 –º–∏–Ω —Ç–µ—Å—Ç</span>
      </div>
      <nav>
        <a href="index.html">‚Üê –ë–∞—Å—Ç—ã –±–µ—Ç</a>
        <a href="geom_prog.html">–ì–µ–æ–º–µ—Ç—Ä–∏—è–ª—ã“õ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è</a>
        <a href="trig.html">–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è</a>
      </nav>
    </div>
    <div class="timer-box">
      <div style="font-size:12px;margin-bottom:3px;">–£–∞“õ—ã—Ç—ã: 15 –º–∏–Ω</div>
      <div class="timer-time" id="timerDisplay">15:00</div>
      <div class="timer-status" id="timerStatus">–û—Ä—ã–Ω–¥–∞—É —É–∞“õ—ã—Ç—ã –∂“Ø—Ä—ñ–ø –∂–∞—Ç—ã—Ä</div>
      <button id="restartTimerBtn" style="margin-top:5px;border-radius:8px;padding:5px 9px;border:0;cursor:pointer;">‚è± 15 –º–∏–Ω “õ–∞–π—Ç–∞ “õ–æ—Å</button>
    </div>
  </header>
  <main>
    <section>
      <div class="card">
        <h2>–¢–µ–æ—Ä–∏—è –∂”ô–Ω–µ –Ω–µ–≥—ñ–∑–≥—ñ —Ñ–æ—Ä–º—É–ª–∞–ª–∞—Ä</h2>
        <span class="formula">a‚Çô = a‚ÇÅ + (n‚àí1)d</span> ‚Äî n-—à—ñ –º“Ø—à–µ <br>
        <span class="formula">S‚Çô = (n/2)(2a‚ÇÅ + (n‚àí1)d)</span> ‚Äî –∞–ª“ì–∞—à“õ—ã n –º“Ø—à–µ–Ω—ñ“£ “õ–æ—Å—ã–Ω–¥—ã—Å—ã<br>
        <span class="formula">d = a‚Çô ‚àí a‚Çô‚Çã‚ÇÅ</span><br>
        <div class="ex"><b>–ú—ã—Å–∞–ª 1:</b> a‚ÇÅ=4, d=6, n=5<br>
          a‚ÇÖ = 4+(5-1)√ó6 = 4+24=28<br>
          S‚ÇÖ = (5/2)(2√ó4+4√ó6)=2.5√ó(8+24)=2.5√ó32=80
        </div>
        <div class="ex"><b>–ú—ã—Å–∞–ª 2:</b> –∞‚ÇÅ=15, d=‚àí2, n=6<br>
          a‚ÇÜ = 15+(6-1)√ó(‚àí2)=5<br>
          S‚ÇÜ=(6/2)(2√ó15+5√ó(‚àí2))=3√ó(30‚àí10)=60
        </div>
      </div>
      <div class="card board">
        <div class="tools">
          <div class="tool">–†–µ–∂–∏–º: <select id="mode"><option value="pen">“ö–∞–ª–∞–º</option><option value="eraser">”®—à—ñ—Ä–≥—ñ—à</option><option value="line">–°—ã–∑“ì—ã—à</option></select></div>
          <div class="tool">“ö–∞–ª—ã“£–¥—ã“ì—ã <input id="size" type="range" min="2" max="15" value="4"></div>
          <div class="tool">–¢“Ø—Å <input id="color" type="color" value="#0ea5e9"></div>
          <button id="undoBtn" class="tool">‚Ü∂ Undo</button>
          <button id="clearBtn" class="tool">üßΩ –¢–∞–∑–∞–ª–∞—É</button>
        </div>
        <canvas id="canvas"></canvas>
      </div>
      <div class="card calc">
        <b>–û–Ω–ª–∞–π–Ω –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</b>
        <span class="chip">a‚Çô, d, S‚Çô</span><br>
        a‚ÇÅ: <input id="a1" type="number" value="2" style="width:43px">
        d: <input id="d" type="number" value="3" style="width:43px">
        n: <input id="n" type="number" value="7" style="width:35px">
        <button id="apcalcBtn">a‚Çô, S‚Çô</button>
        <span id="apout" class="out"></span>
      </div>
    </section>
    <section>
      <div class="card">
        <h2>–¢–µ—Å—Ç (10 —Å“±—Ä–∞“õ, 10 –±–∞–ª–ª)</h2>
        <div id="testArea"></div>
        <div class="test-result" id="testResult"></div>
        <h2 style="margin-top:15px;">–°”ô–π–∫–µ—Å—Ç–µ–Ω–¥—ñ—Ä—É (5 –∂“±–ø)</h2>
        <div class="match-grid" id="matchArea"></div>
        <div class="test-result" id="matchResult"></div>
        <h2>–¢–µ–∫—Å–µ—Ä—É –∂”ô–Ω–µ –Ω”ô—Ç–∏–∂–µ —Å–∞“õ—Ç–∞—É</h2>
        <div class="save-box">
          <span id="scoreSummary">–ñ–∞–ª–ø—ã –±–∞–ª–ª: ”ô–ª—ñ –µ—Å–µ–ø—Ç–µ–ª–≥–µ–Ω –∂–æ“õ</span>
          <button id="checkAllBtn" style="margin:3px 8px;">‚úÖ –¢–µ–∫—Å–µ—Ä—É</button>
          <label>–ê—Ç—ã-–∂”©–Ω—ñ:<input id="studentName"/></label>
          <button id="saveResultBtn">üíæ –°–∞“õ—Ç–∞—É</button>
        </div>
        <div style="color:var(--muted);font-size:12px;margin:3px 0;" id="saveMessage"></div>
        <table class="saved-table" id="resultsTable">
          <thead><tr><th>‚Ññ</th><th>–ê—Ç—ã-–∂”©–Ω—ñ</th><th>–ë–∞–ª–ª</th><th>–£–∞“õ—ã—Ç—ã</th><th>“ö–∞–ª“ì–∞–Ω —É–∞“õ.</th></tr></thead>
          <tbody></tbody>
        </table>
        <button id="clearResultsBtn" style="margin-top:6px;">üóë –¢–∞–∑–∞–ª–∞—É</button>
      </div>
    </section>
  </main>
  <footer>
    –î–µ—Ä–µ–∫—Ç–µ—Ä –±—Ä–∞—É–∑–µ—Ä–¥–µ —Å–∞“õ—Ç–∞–ª–∞–¥—ã. –ë–∞—Å—Ç—ã –±–µ—Ç ‚Äî index.html –∞—Ä“õ—ã–ª—ã ”©—Ç–µ—Å—ñ“£.
  </footer>
</div>
<script>
  // –¢–∞–π–º–µ—Ä
  const TIMER_SEC = 15*60; let remaining=TIMER_SEC,timerId=null;
  const timerDisplay=document.getElementById('timerDisplay'),timerStatus=document.getElementById('timerStatus'),restartTimerBtn=document.getElementById('restartTimerBtn');
  function ftime(sec){let m=Math.floor(sec/60),s=sec%60;return String(m).padStart(2,0)+':'+String(s).padStart(2,0);}
  function updateTimerUI(){timerDisplay.textContent=ftime(remaining);
    if(remaining<=0){timerStatus.textContent='–£–∞“õ—ã—Ç –∞—è“õ—Ç–∞–ª–¥—ã.';clearInterval(timerId);timerId=null;}
    else if(remaining<=180){timerStatus.textContent='“ö–∞–ª“ì–∞–Ω —É–∞“õ—ã—Ç –∞–∑! –ñ—ã–ª–¥–∞–º!';}
    else timerStatus.textContent='–û—Ä—ã–Ω–¥–∞—É —É–∞“õ—ã—Ç—ã –∂“Ø—Ä—ñ–ø –∂–∞—Ç—ã—Ä';}
  function startTimer(){if(timerId)clearInterval(timerId);remaining=TIMER_SEC;updateTimerUI();
    timerId=setInterval(()=>{remaining--;updateTimerUI();if(remaining<=0)clearInterval(timerId);},1000);}
  restartTimerBtn.onclick=startTimer;startTimer();
  // Board
  const canvas=document.getElementById('canvas'),ctx=canvas.getContext('2d'),modeEl=document.getElementById('mode'),sizeEl=document.getElementById('size'),colorEl=document.getElementById('color');
  let drawing=false,lastX=0,lastY=0,lineStart=null,history=[];
  function fitCanvas(){const r=canvas.getBoundingClientRect(),dpr=window.devicePixelRatio||1;canvas.width=Math.floor(r.width*dpr);canvas.height=Math.floor(r.height*dpr);ctx.setTransform(dpr,0,0,dpr,0,0);if(history.length){const img=new Image();img.onload=()=>ctx.drawImage(img,0,0,r.width,r.height);img.src=history[history.length-1];}}
  function snapshot(){history.push(canvas.toDataURL());if(history.length>12)history.shift();}
  function getPos(e){const r=canvas.getBoundingClientRect(),x=(e.touches?e.touches[0].clientX:e.clientX)-r.left,y=(e.touches?e.touches[0].clientY:e.clientY)-r.top;return{x,y};}
  function start(e){e.preventDefault();const{x,y}=getPos(e),mode=modeEl.value;if(mode==='line'){if(!lineStart){lineStart={x,y};}else{snapshot();ctx.save();ctx.lineCap='round';ctx.lineJoin='round';ctx.lineWidth=+sizeEl.value;ctx.strokeStyle=colorEl.value;ctx.beginPath();ctx.moveTo(lineStart.x,lineStart.y);ctx.lineTo(x,y);ctx.stroke();ctx.restore();lineStart=null;}return;}snapshot();drawing=true;lastX=x;lastY=y;}
  function move(e){if(!drawing)return;e.preventDefault();const{x,y}=getPos(e),mode=modeEl.value;ctx.save();ctx.lineCap='round';ctx.lineJoin='round';ctx.lineWidth=+sizeEl.value;if(mode==='eraser'){ctx.globalCompositeOperation='destination-out';ctx.strokeStyle='rgba(0,0,0,1)';}else{ctx.globalCompositeOperation='source-over';ctx.strokeStyle=colorEl.value;}ctx.beginPath();ctx.moveTo(lastX,lastY);ctx.lineTo(x,y);ctx.stroke();ctx.restore();lastX=x;lastY=y;}
  function end(){drawing=false;}
  document.getElementById('clearBtn').onclick=()=>{snapshot();ctx.clearRect(0,0,canvas.width,canvas.height);lineStart=null;};
  document.getElementById('undoBtn').onclick=()=>{if(history.length<2)return;history.pop();const img=new Image();img.onload=()=>{const r=canvas.getBoundingClientRect();ctx.clearRect(0,0,canvas.width,canvas.height);ctx.drawImage(img,0,0,r.width,r.height);};img.src=history[history.length-1];lineStart=null;};
  canvas.addEventListener('mousedown',start);canvas.addEventListener('mousemove',move);window.addEventListener('mouseup',end);
  canvas.addEventListener('touchstart',start,{passive:false});canvas.addEventListener('touchmove',move,{passive:false});window.addEventListener('touchend',end);
  window.addEventListener('resize',fitCanvas);fitCanvas();snapshot();
  // –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
  apcalcBtn.onclick=()=>{let a=+a1.value,dv=+d.value,nv=+n.value;if(isNaN(a)||isNaN(dv)||isNaN(nv)){apout.textContent="“ö–∞—Ç–µ.";return;}
    let an=a+(nv-1)*dv, S=(nv/2)*(2*a+(nv-1)*dv);
    apout.textContent="a‚Çô="+an+", S‚Çô="+S;
  }
  // –¢–µ—Å—Ç
  const testQuestions=[
    {q:"1) a‚ÇÅ=4, d=6, n=5. a‚ÇÖ=?",options:["24","28","30","16"],correct:1},
    {q:"2) a‚ÇÅ=2, d=5, n=8. a‚Çà=?",options:["37","36","33","39"],correct:0},
    {q:"3) a‚ÇÅ=10, d=‚àí2, n=7. a‚Çá=?",options:["‚àí2","2","0","‚àí4"],correct:1},
    {q:"4) a‚ÇÅ=3, d=5, n=6. S‚ÇÜ=?",options:["111","78","93","66"],correct:2},
    {q:"5) a‚ÇÅ=1, d=3, n=9. S‚Çâ=?",options:["117","115","135","81"],correct:1},
    {q:"6) a‚ÇÅ=4, d=0, n=6. a‚ÇÜ=?",options:["4","0","24","8"],correct:0},
    {q:"7) 5, 9, 13,... –∞–π—ã—Ä–º–∞—Å—ã d=?",options:["2","3","4","5"],correct:2},
    {q:"8) a‚ÇÅ=10, d=‚àí2, n=15. a‚ÇÅ‚ÇÖ=?",options:["‚àí22","‚àí16","‚àí18","‚àí20"],correct:3},
    {q:"9) –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞–ª—ã“õ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è. d=0 –º“Ø–º–∫—ñ–Ω –±–µ?",options:["–ò”ô, –±–∞—Ä–ª—ã“õ –º“Ø—à–µ—Å—ñ –±—ñ—Ä–¥–µ–π.","–ñ–æ“õ, –±–æ–ª–º–∞–π–¥—ã.","–¢–µ–∫ –∂“±–ø n “Ø—à—ñ–Ω.","–¢–µ–∫ a‚ÇÅ‚â†0 –±–æ–ª—Å–∞."],correct:0},
    {q:"10) “ö–æ—Å—ã–Ω–¥—ã–Ω—ã“£ —Ñ–æ—Ä–º—É–ª–∞—Å—ã?",options:["S‚Çô = (n/2)(2a‚ÇÅ+(n-1)d)","a‚Çô = a‚ÇÅ+(n-1)d","S‚Çô = b‚ÇÅ(q‚Åø‚àí1)/(q‚àí1)","d = a‚Çô‚àía‚Çô‚Çã‚ÇÅ"],correct:0}
  ];
  const testArea=document.getElementById('testArea');
  function renderTest(){
    testArea.innerHTML = '';
    testQuestions.forEach((q, idx) => {
      const div = document.createElement('div');
      div.className = 'question';
      div.dataset.index = idx;
      const title = document.createElement('div');
      title.className = 'question-title';
      title.textContent = q.q;
      div.appendChild(title);
      q.options.forEach((opt, i) => {
        const id = `q${idx}_opt${i}`;
        const label = document.createElement('label');
        label.className = 'option';
        label.htmlFor = id;
        const radio = document.createElement('input');
        radio.type = 'radio';
        radio.name = `q${idx}`;
        radio.id = id;
        radio.value = i;
        label.appendChild(radio);
        label.appendChild(document.createTextNode(' '+opt));
        div.appendChild(label);
      });
      const fb = document.createElement('div');
      fb.className = 'small-feedback'; fb.id = `fb${idx}`; div.appendChild(fb);
      testArea.appendChild(div);
    });
  }
  renderTest();
  function checkTest(){
    let score=0, details=[];
    testQuestions.forEach((q, idx)=>{
      const sel=document.querySelector(`input[name="q${idx}"]:checked`);
      const fb=document.getElementById(`fb${idx}`);
      if(!sel){ fb.textContent="–ñ–∞—É–∞–ø —Ç–∞“£–¥–∞–ª–º–∞“ì–∞–Ω."; fb.className='small-feedback wrong'; details.push(`–°${idx+1}: –∂–æ“õ.`); return;}
      if(Number(sel.value)===q.correct){score++;fb.textContent="–î“±—Ä—ã—Å!";fb.className='small-feedback correct';}
      else{fb.textContent="“ö–∞—Ç–µ.";fb.className='small-feedback wrong';details.push(`–°${idx+1}: “õ–∞—Ç–µ.`);}
    });
    return {score,details};
  }
  // –°”ô–π–∫–µ—Å—Ç–µ–Ω–¥—ñ—Ä—É
  const matchPairs=[
    {formula:"a‚Çô = a‚ÇÅ + (n-1)d",letter:"a",desc:"n-—à—ñ –º“Ø—à–µ —Ñ–æ—Ä–º—É–ª–∞—Å—ã"},
    {formula:"S‚Çô = (n/2)(2a‚ÇÅ + (n-1)d)",letter:"b",desc:"“õ–æ—Å—ã–Ω–¥—ã —Ñ–æ—Ä–º—É–ª–∞—Å—ã"},
    {formula:"d = a‚Çô ‚àí a‚Çô‚Çã‚ÇÅ",letter:"c",desc:"–∞–π—ã—Ä–º–∞ —Ñ–æ—Ä–º—É–ª–∞—Å—ã"},
    {formula:"a‚ÇÅ",letter:"d",desc:"–±—ñ—Ä—ñ–Ω—à—ñ –º“Ø—à–µ"},
    {formula:"a‚Çô",letter:"e",desc:"n-—à—ñ –º“Ø—à–µ–Ω—ñ“£ –º”ô–Ω—ñ"}
  ];
  const matchArea=document.getElementById('matchArea');
  function renderMatch(){
    const leftCol=document.createElement('div'),rightCol=document.createElement('div');
    matchPairs.forEach((item,idx)=>{
      const d=document.createElement('div');
      d.className='match-item';
      d.innerHTML=`<strong>${idx+1}) ${item.formula}</strong><br>–ñ–∞—É–∞–±—ã: <input maxlength="1" data-index="${idx}" />`;
      leftCol.appendChild(d);
    });
    const shuffled=[...matchPairs].sort(()=>Math.random()-.5);
    shuffled.forEach(item=>{
      const d=document.createElement('div');
      d.className='match-item';
      d.innerHTML=`<strong>${item.letter})</strong> ${item.desc}`;
      rightCol.appendChild(d);
    });
    matchArea.innerHTML='';matchArea.appendChild(leftCol);matchArea.appendChild(rightCol);
  }
  renderMatch();
  function checkMatch(){
    const inputs=matchArea.querySelectorAll('input[data-index]');
    let correct=0,total=matchPairs.length;
    inputs.forEach(inp=>{
      const idx=Number(inp.dataset.index);
      const val=(inp.value||'').trim().toLowerCase();
      if(val===matchPairs[idx].letter){correct++;inp.style.borderColor='var(--good)';}
      else inp.style.borderColor='var(--danger)';
    });
    return {correct,total};
  }
  // –¢–µ–∫—Å–µ—Ä—É/–°–∞“õ—Ç–∞—É
  const checkAllBtn=document.getElementById('checkAllBtn'),scoreSummaryEl=document.getElementById('scoreSummary');
  let lastScore=null;
  checkAllBtn.onclick=()=>{
    const testRes=checkTest(),matchRes=checkMatch();
    const mainScore=testRes.score,bonus=matchRes.correct*0.2,totalScore=Math.min(10,+(mainScore+bonus).toFixed(1));
    lastScore=totalScore;
    scoreSummaryEl.textContent="–ñ–∞–ª–ø—ã –±–∞–ª–ª: "+totalScore+" / 10.";
    testResult.style.display='block'; testResult.textContent=`–¢–µ—Å—Ç: ${testRes.score}/10.`;
    matchResult.style.display='block'; matchResult.textContent=`–°”ô–π–∫–µ—Å—Ç–µ–Ω–¥—ñ—Ä—É: ${matchRes.correct}/${matchRes.total}.`;
  };
  // LocalStorage
  const saveResultBtn=document.getElementById('saveResultBtn'),studentNameEl=document.getElementById('studentName'),saveMessageEl=document.getElementById('saveMessage'),resultsTableBody=document.querySelector('#resultsTable tbody'),clearResultsBtn=document.getElementById('clearResultsBtn');
  const STORAGE_KEY='mathBoard_ap_results';
  function loadResults(){const raw=localStorage.getItem(STORAGE_KEY);if(!raw)return[];try{const arr=JSON.parse(raw);return Array.isArray(arr)?arr:[];}catch(e){return[];}}
  function saveResults(arr){localStorage.setItem(STORAGE_KEY,JSON.stringify(arr));}
  function renderResultsTable(){const arr=loadResults();resultsTableBody.innerHTML='';arr.forEach((row,idx)=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${idx+1}</td><td>${row.name}</td><td>${row.score}</td><td>${row.time}</td><td>${row.remaining}</td>`;resultsTableBody.appendChild(tr);});}
  renderResultsTable();
  saveResultBtn.onclick=()=>{
    if(lastScore==null){saveMessageEl.textContent="–ê–ª–¥—ã–º–µ–Ω ‚Äú–¢–µ–∫—Å–µ—Ä—É‚Äù –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑.";saveMessageEl.style.color='var(--danger)';return;}
    const name=studentNameEl.value.trim();if(!name){saveMessageEl.textContent="–ê—Ç—ã-–∂”©–Ω—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—ã“£—ã–∑.";saveMessageEl.style.color='var(--danger)';return;}
    const now=new Date(),timeStr=now.toLocaleString('kk-KZ',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'});
    const result={name,score:lastScore,time:timeStr,remaining:ftime(remaining)};
    const arr=loadResults();arr.push(result);saveResults(arr);renderResultsTable();
    saveMessageEl.textContent="–ù”ô—Ç–∏–∂–µ —Å–∞“õ—Ç–∞–ª–¥—ã.";saveMessageEl.style.color='var(--good)';
  };
  clearResultsBtn.onclick=()=>{if(confirm('–ë–∞—Ä–ª—ã“õ –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä–¥—ñ ”©—à—ñ—Ä—É–¥—ñ “õ–∞–ª–∞–π—Å—ã–∑ –±–∞?')){saveResults([]);renderResultsTable();saveMessageEl.textContent='–ë–∞—Ä–ª—ã“õ –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä ”©—à—ñ—Ä—ñ–ª–¥—ñ.';saveMessageEl.style.color='var(--muted)';}};
</script>
</body>
</html>
