<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8">
  <title>–§—É–Ω–∫—Ü–∏—è ‚Äî —Ç–µ—Å—Ç, —Ç–∞“õ—Ç–∞, –≥—Ä–∞—Ñ–∏–∫ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root{--card:#fff;--bg:#f4f8f5;--muted:#334155;--accent:#10b981;--danger:#ef4444;--good:#22c55e;}
    body{margin:0;background:var(--bg);font-family:sans-serif;}
    .container{max-width:1120px;margin:0 auto;padding:20px 12px 65px;}
    header{display:flex;justify-content:space-between;align-items:flex-start;gap:14px;margin-bottom:18px;padding:13px 15px;background:var(--card);box-shadow:0 1px 15px #10b98133;border-radius:17px;}
    @media(max-width:990px){header{flex-direction:column;}}
    .title h1{margin:0 0 6px;font-size:21px;color:var(--accent);}
    .title p{margin:1px 0 6px 0;color:var(--muted);font-size:13px;}
    .badge-row{display:flex;gap:8px;margin-bottom:5px;}
    .badge{padding:5px 8px;border-radius:99px;background:#a7f3d0;color:#047857;font-size:12px;}
    nav a{font-size:13px;color:var(--accent);margin-right:10px;}
    .timer-box{min-width:200px;padding:9px 13px;background:var(--accent);color:#fff;border-radius:14px;box-shadow:0 0 18px #10b98133;}
    .timer-time{font-size:25px;font-weight:900;}
    .timer-status{font-size:13px;}
    main{display:grid;grid-template-columns: 1.06fr 0.94fr;gap:14px;align-items:flex-start;}
    @media(max-width:980px){main{grid-template-columns:1fr;}}
    .card{background:var(--card);border-radius:16px;padding:14px 20px;margin-bottom:17px;box-shadow:0 2px 13px #10b98123;}
    h2{margin-top:0;}
    h3{margin-top:15px;}
    .formula{background:#a7f3d0;border-radius:999px;padding:4px 11px;font-size:13px;font-weight:700;color:#059669;}
    .ex{background:#e0fff7;padding:9px 13px 10px 17px;border-radius:10px;font-size:13px;}
    ul{font-size:14px;}
    .board{background:#fff;padding:10px 9px 15px;border-radius:14px;margin-bottom:13px;}
    .tools{display:flex;gap:7px;align-items:center;}
    .tools .tool{padding:5px 9px;border-radius:9px;background:#a7f3d0;font-size:13px;font-weight:700;}
    canvas{width:100%;height:180px;border-radius:12px;background:#e7fcf3;border:1px solid #a7f3d0;}
    .calc{background:#e0fff7;padding:11px 13px 13px;border-radius:12px;}
    .calc select, .calc input{padding:7px 11px;border-radius:9px;border:1px solid #6ee7b7;margin-bottom:7px;}
    .calc .out{background:var(--accent);color:#fff;padding:7px 9px;border-radius:7px;margin-top:4px;font-size:13px;}
    .question{margin-bottom:12px;padding:9px 11px;background:#e3faec;border-radius:11px;}
    .question-title{font-weight:700;margin-bottom:6px;}
    label.option{display:block;font-size:13px;margin-bottom:3px;}
    .small-feedback{font-size:12px;margin-top:3px;}
    .small-feedback.correct{color:var(--good);}
    .small-feedback.wrong{color:var(--danger);}
    .test-result{padding:8px 12px;border-radius:10px;background:#a7f3d0;font-size:13px;margin:8px 0;}
    .match-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
    .match-item{padding:7px 10px;border-radius:7px;background:#d1fae5;margin:5px 0;}
    .match-item input{width:38px;border-radius:6px;}
    .save-box{margin-top:10px;padding:7px 11px;border-radius:10px;background:#f3f7f3;display:flex;gap:7px;align-items:center;}
    .save-box input{padding:6px 10px;font-size:13px;border-radius:999px;border:1px solid #6ee7b7;min-width:130px;}
    .saved-table{width:100%;border-collapse:collapse;margin-top:7px;font-size:12px;}
    .saved-table th,.saved-table td{border:1px solid #6ee7b7;padding:4px 6px;}
    .saved-table th{background:#a7f3d0;}
    .chip{padding:5px 8px;border-radius:99px;background:#a7f3d0;font-size:12px;}
    footer{margin-top:16px;}
  </style>
</head>
<body>
<div class="container">
  <header>
    <div class="title">
      <h1>–§—É–Ω–∫—Ü–∏—è–ª–∞—Ä ‚Äî —Ç–µ—Å—Ç, —Ç–∞“õ—Ç–∞, –≥—Ä–∞—Ñ–∏–∫ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã</h1>
      <p>y=kx+b, y=ax¬≤+bx+c, y=a/x, y=‚àöx, |x|, —Ç–µ—Å—Ç, —Ç–∞“õ—Ç–∞, –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä: –≥—Ä–∞—Ñ–∏–∫ –∞–≤—Ç–æ —Å—ã–∑—ã–ª–∞–¥—ã!</p>
      <div class="badge-row">
        <span class="badge">8‚Äì9 —Å—ã–Ω—ã–ø</span>
        <span class="badge">–§—É–Ω–∫—Ü–∏—è –≥—Ä–∞—Ñ–∏–≥—ñ</span>
        <span class="badge">15 –º–∏–Ω —Ç–µ—Å—Ç</span>
      </div>
      <nav>
        <a href="index.html">‚Üê –ë–∞—Å—Ç—ã –±–µ—Ç</a>
        <a href="trig.html">–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è</a>
      </nav>
    </div>
    <div class="timer-box">
      <div style="font-size:12px;margin-bottom:3px;">–£–∞“õ—ã—Ç—ã: 15 –º–∏–Ω</div>
      <div class="timer-time" id="timerDisplay">15:00</div>
      <div class="timer-status" id="timerStatus">–û—Ä—ã–Ω–¥–∞—É —É–∞“õ—ã—Ç—ã –∂“Ø—Ä—ñ–ø –∂–∞—Ç—ã—Ä</div>
      <button id="restartTimerBtn" style="margin-top:5px;border-radius:8px;padding:5px 9px;border:0;cursor:pointer;">‚è± 15 –º–∏–Ω “õ–∞–π—Ç–∞ “õ–æ—Å</button>
    </div>
  </header>
  <main>
    <section>
      <div class="card">
        <h2>–¢–µ–æ—Ä–∏—è –∂”ô–Ω–µ –º—ã—Å–∞–ª</h2>
        <span class="formula">y = kx + b</span> ‚Äî —Å—ã–∑—ã“õ—Ç—ã“õ<br>
        <span class="formula">y = ax¬≤ + bx + c</span> ‚Äî –∫–≤–∞–¥—Ä–∞—Ç—Ç—ã“õ<br>
        <span class="formula">y = a/x</span> ‚Äî –∫–µ—Ä—ñ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª<br>
        <span class="formula">y = ‚àöx</span> ‚Äî —Ç“Ø–±—ñ—Ä —Ñ—É–Ω–∫—Ü–∏—è<br>
        <span class="formula">y = |x|</span> ‚Äî –º–æ–¥—É–ª—å–¥—ñ–∫<br>
        <div class="ex"><b>–ú—ã—Å–∞–ª 1:</b> y = 2x + 3. (k=2, b=3). x=0: y=3, x=‚àí1: y=1, x=2: y=7</div>
        <div class="ex"><b>–ú—ã—Å–∞–ª 2:</b> y = x¬≤ ‚àí 4x + 5. x=1: y=1‚àí4+5=2; x=2: y=4‚àí8+5=1</div>
      </div>
      <div class="card calc">
        <b>–ì—Ä–∞—Ñ–∏–∫ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã + —Ñ–∏–≥—É—Ä–∞ —Å–∞–ª—É</b>
        <span class="chip">–º”ô–Ω–¥–µ—Ä–¥—ñ –µ–Ω–≥—ñ–∑ ‚Äî –≥—Ä–∞—Ñ–∏–∫ –∞–≤—Ç–æ-—à—ã“ì–∞–¥—ã</span><br>
        <select id="funType">
          <option value="lin">y = kx+b</option>
          <option value="sq">y = ax¬≤+bx+c</option>
          <option value="inv">y = a/x</option>
          <option value="sqrt">y = ‚àöx</option>
          <option value="abs">y = |x|</option>
        </select>
        <span id="funFields"></span>
        <button id="funCalcBtn">‚éå –ì—Ä–∞—Ñ–∏–∫ —Å—ã–∑—É</button>
        <span id="funCalcOut" class="out"></span>
      </div>
      <div class="card board">
        <div class="tools">
          <div class="tool">–†–µ–∂–∏–º: <select id="mode"><option value="pen">“ö–∞–ª–∞–º</option><option value="eraser">”®—à—ñ—Ä–≥—ñ—à</option><option value="line">–°—ã–∑“ì—ã—à</option></select></div>
          <div class="tool">“ö–∞–ª—ã“£–¥—ã“õ <input id="size" type="range" min="2" max="15" value="4"></div>
          <div class="tool">–¢“Ø—Å <input id="color" type="color" value="#10b981"></div>
          <button id="undoBtn" class="tool">‚Ü∂ Undo</button>
          <button id="clearBtn" class="tool">üßΩ –¢–∞–∑–∞–ª–∞—É</button>
        </div>
        <canvas id="canvas" style="background:#e7fcf3;"></canvas>
      </div>
    </section>
    <section>
      <div class="card">
        <h2>–¢–µ—Å—Ç (10 —Å“±—Ä–∞“õ, 10 –±–∞–ª–ª)</h2>
        <div id="testArea"></div>
        <div class="test-result" id="testResult"></div>
        <h2 style="margin-top:15px;">–°”ô–π–∫–µ—Å—Ç–µ–Ω–¥—ñ—Ä—É (5 –∂“±–ø)</h2>
        <div class="match-grid" id="matchArea"></div>
        <div class="test-result" id="matchResult"></div>
        <h2>–¢–µ–∫—Å–µ—Ä—É –∂”ô–Ω–µ –Ω”ô—Ç–∏–∂–µ —Å–∞“õ—Ç–∞—É</h2>
        <div class="save-box">
          <span id="scoreSummary">–ñ–∞–ª–ø—ã –±–∞–ª–ª: ”ô–ª—ñ –µ—Å–µ–ø—Ç–µ–ª–≥–µ–Ω –∂–æ“õ</span>
          <button id="checkAllBtn" style="margin:3px 8px;">‚úÖ –¢–µ–∫—Å–µ—Ä—É</button>
          <label>–ê—Ç—ã-–∂”©–Ω—ñ:<input id="studentName"/></label>
          <button id="saveResultBtn">üíæ –°–∞“õ—Ç–∞—É</button>
        </div>
        <div style="color:var(--muted);font-size:12px;margin:3px 0;" id="saveMessage"></div>
        <table class="saved-table" id="resultsTable">
          <thead><tr><th>‚Ññ</th><th>–ê—Ç—ã-–∂”©–Ω—ñ</th><th>–ë–∞–ª–ª</th><th>–£–∞“õ—ã—Ç—ã</th><th>“ö–∞–ª“ì–∞–Ω —É–∞“õ.</th></tr></thead>
          <tbody></tbody>
        </table>
        <button id="clearResultsBtn" style="margin-top:6px;">üóë –¢–∞–∑–∞–ª–∞—É</button>
      </div>
    </section>
  </main>
  <footer>
    –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä: –º”ô–Ω–¥–µ—Ä–¥—ñ –±–µ—Ä—Å–µ“£, —Ç–∞“õ—Ç–∞–¥–∞ –≥—Ä–∞—Ñ–∏–∫ –∞–≤—Ç–æ–º–∞—Ç —Å—ã–∑—ã–ª–∞–¥—ã. –ë–∞—Å—Ç—ã –±–µ—Ç: index.html
  </footer>
</div>
<script>
  // –¢–∞–π–º–µ—Ä
  const TIMER_SEC = 15*60; let remaining=TIMER_SEC,timerId=null;
  const timerDisplay=document.getElementById('timerDisplay'),timerStatus=document.getElementById('timerStatus'),restartTimerBtn=document.getElementById('restartTimerBtn');
  function ftime(sec){let m=Math.floor(sec/60),s=sec%60;return String(m).padStart(2,0)+':'+String(s).padStart(2,0);}
  function updateTimerUI(){timerDisplay.textContent=ftime(remaining);
    if(remaining<=0){timerStatus.textContent='–£–∞“õ—ã—Ç –∞—è“õ—Ç–∞–ª–¥—ã.';clearInterval(timerId);timerId=null;}
    else if(remaining<=180){timerStatus.textContent='“ö–∞–ª“ì–∞–Ω —É–∞“õ—ã—Ç –∞–∑! –ñ—ã–ª–¥–∞–º!';}
    else timerStatus.textContent='–û—Ä—ã–Ω–¥–∞—É —É–∞“õ—ã—Ç—ã –∂“Ø—Ä—ñ–ø –∂–∞—Ç—ã—Ä';}
  function startTimer(){if(timerId)clearInterval(timerId);remaining=TIMER_SEC;updateTimerUI();
    timerId=setInterval(()=>{remaining--;updateTimerUI();if(remaining<=0)clearInterval(timerId);},1000);}
  restartTimerBtn.onclick=startTimer;startTimer();

  // Board
  const canvas=document.getElementById('canvas'),ctx=canvas.getContext('2d'),modeEl=document.getElementById('mode'),sizeEl=document.getElementById('size'),colorEl=document.getElementById('color');
  let drawing=false,lastX=0,lastY=0,lineStart=null,history=[];
  function fitCanvas(){
    const r=canvas.getBoundingClientRect(),dpr=window.devicePixelRatio||1;
    canvas.width=Math.floor(r.width*dpr);canvas.height=Math.floor(r.height*dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);
    if(history.length){const img=new Image();img.onload=()=>ctx.drawImage(img,0,0,r.width,r.height);img.src=history[history.length-1];}
  }
  function snapshot(){history.push(canvas.toDataURL());if(history.length>12)history.shift();}
  function getPos(e){const r=canvas.getBoundingClientRect(),x=(e.touches?e.touches[0].clientX:e.clientX)-r.left,y=(e.touches?e.touches[0].clientY:e.clientY)-r.top;return{x,y};}
  function start(e){e.preventDefault();const{x,y}=getPos(e),mode=modeEl.value;if(mode==='line'){if(!lineStart){lineStart={x,y};}else{snapshot();ctx.save();ctx.lineCap='round';ctx.lineJoin='round';ctx.lineWidth=+sizeEl.value;ctx.strokeStyle=colorEl.value;ctx.beginPath();ctx.moveTo(lineStart.x,lineStart.y);ctx.lineTo(x,y);ctx.stroke();ctx.restore();lineStart=null;}return;}snapshot();drawing=true;lastX=x;lastY=y;}
  function move(e){if(!drawing)return;e.preventDefault();const{x,y}=getPos(e),mode=modeEl.value;ctx.save();ctx.lineCap='round';ctx.lineJoin='round';ctx.lineWidth=+sizeEl.value;if(mode==='eraser'){ctx.globalCompositeOperation='destination-out';ctx.strokeStyle='rgba(0,0,0,1)';}else{ctx.globalCompositeOperation='source-over';ctx.strokeStyle=colorEl.value;}ctx.beginPath();ctx.moveTo(lastX,lastY);ctx.lineTo(x,y);ctx.stroke();ctx.restore();lastX=x;lastY=y;}
  function end(){drawing=false;}
  document.getElementById('clearBtn').onclick=()=>{snapshot();ctx.clearRect(0,0,canvas.width,canvas.height);lineStart=null;};
  document.getElementById('undoBtn').onclick=()=>{if(history.length<2)return;history.pop();const img=new Image();img.onload=()=>{const r=canvas.getBoundingClientRect();ctx.clearRect(0,0,canvas.width,canvas.height);ctx.drawImage(img,0,0,r.width,r.height);};img.src=history[history.length-1];lineStart=null;};
  canvas.addEventListener('mousedown',start);canvas.addEventListener('mousemove',move);window.addEventListener('mouseup',end);
  canvas.addEventListener('touchstart',start,{passive:false});canvas.addEventListener('touchmove',move,{passive:false});window.addEventListener('touchend',end);
  window.addEventListener('resize',fitCanvas);fitCanvas();snapshot();

  // --- –§—É–Ω–∫—Ü–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä (+ –∞–≤—Ç–æ–º–∞—Ç –≥—Ä–∞—Ñ–∏–∫)
  const funType=document.getElementById('funType'),funFields=document.getElementById('funFields'),
    funCalcBtn=document.getElementById('funCalcBtn'),funCalcOut=document.getElementById('funCalcOut');
  function renderFunFields(){
    let v=funType.value;
    if(v==='lin')
      funFields.innerHTML='k:<input id="fk" value="2" type="number" style="width:43px"> b:<input id="fb" value="1" type="number" style="width:43px">';
    else if(v==='sq')
      funFields.innerHTML='a:<input id="fa" value="1" type="number" style="width:43px"> b:<input id="fb" value="0" type="number" style="width:43px"> c:<input id="fc" value="0" type="number" style="width:43px">';
    else if(v==='inv')
      funFields.innerHTML='a:<input id="fa" value="4" type="number" style="width:43px">';
    else if(v==='sqrt')
      funFields.innerHTML='';
    else if(v==='abs')
      funFields.innerHTML='';
    funCalcOut.textContent="";
  }
  funType.onchange=renderFunFields;renderFunFields();

  function drawGraph(func) {
    fitCanvas();
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // —Ç–æ—Ä (–æ—Å—å—Ç–µ—Ä)
    ctx.save();
    let w=canvas.width, h=canvas.height, midx=w/2, midy=h/2, kx=w/20, ky=h/20;
    // Y
    ctx.strokeStyle="#bbb";ctx.lineWidth=1.1;
    for(let i=0;i<=w;i+=kx) {ctx.beginPath();ctx.moveTo(i,0);ctx.lineTo(i,h);ctx.stroke();}
    for(let i=0;i<=h;i+=ky) {ctx.beginPath();ctx.moveTo(0,i);ctx.lineTo(w,i);ctx.stroke();}
    ctx.strokeStyle="#059669";ctx.lineWidth=2;
    // –æ—Å—å X
    ctx.beginPath();ctx.moveTo(0,midy);ctx.lineTo(w,midy);ctx.stroke();
    // –æ—Å—å Y
    ctx.beginPath();ctx.moveTo(midx,0);ctx.lineTo(midx,h);ctx.stroke();
    ctx.restore();
    // –Ω–∞“õ—Ç—ã –≥—Ä–∞—Ñ–∏–∫ (–∂–∞—Å—ã–ª)
    ctx.save();
    ctx.strokeStyle="#5eead4";ctx.lineWidth=3;ctx.beginPath();
    let X=-10,Y; let first=true;
    for(let px=0;px<=w;px+=1){
      X=(px-midx)/kx;
      try{ Y=func(X); }catch(e){Y=NaN;}
      if(!isFinite(Y)) {first=true;continue;}
      let py=midy-Y*ky;
      if(first){ctx.moveTo(px,py);first=false;}
      else ctx.lineTo(px,py);
    }
    ctx.stroke();ctx.restore();
  }

  funCalcBtn.onclick=()=>{
    let type=funType.value;
    let out="", fk,fa,fb,fc;
    if(type==='lin'){
      fk=+document.getElementById('fk').value;fb=+document.getElementById('fb').value;
      out=`y=${fk}x+${fb}`;
      drawGraph(x=>fk*x+fb);
    }
    else if(type==='sq'){
      fa=+document.getElementById('fa').value;fb=+document.getElementById('fb').value;fc=+document.getElementById('fc').value;
      out=`y=${fa}x¬≤+${fb}x+${fc}`;
      drawGraph(x=>fa*x*x+fb*x+fc);
    }
    else if(type==='inv'){
      fa=+document.getElementById('fa').value;
      out=`y=${fa}/x`;
      drawGraph(x=>x!==0?fa/x:NaN);
    }
    else if(type==='sqrt'){
      out="y=‚àöx";
      drawGraph(x=>x>=0?Math.sqrt(x):NaN);
    }
    else if(type==='abs'){
      out="y=|x|";
      drawGraph(x=>Math.abs(x));
    }
    funCalcOut.textContent=out;
  };

  // TEST
  const testQuestions=[
    {q:"–§—É–Ω–∫—Ü–∏—è –≥—Ä–∞—Ñ–∏–≥—ñ: y=3x+2. –ì—Ä–∞—Ñ–∏–∫–∞ —Ç“Ø—Ä—ñ?", options:["–°—ã–∑—ã“õ—Ç—ã“õ","–ü–∞—Ä–∞–±–æ–ª–∞","–ì–∏–ø–µ—Ä–±–æ–ª–∞","–®–µ“£–±–µ—Ä"],correct:0},
    {q:"–§—É–Ω–∫—Ü–∏—è: y=ax¬≤+bx+c. –ë“±–ª ‚Äî ...", options:["–°—ã–∑—ã“õ","–ü–∞—Ä–∞–±–æ–ª–∞","–ì–∏–ø–µ—Ä–±–æ–ª–∞","–°–∏–º–º–µ—Ç—Ä–∏—è"],correct:1},
    {q:"–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç k>0 –±–æ–ª—Å–∞, y=kx+b –≥—Ä–∞—Ñ–∏–≥—ñ–Ω—ñ“£ –±“±—Ä—ã—à—ã...", options:["”®—Ä–ª–µ–º–µ–ª—ñ","–¢”©–º–µ–Ω —Ç“Ø—Å–µ–¥—ñ","–¢“±—Ä–∞“õ—Ç—ã","–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å"],correct:0},
    {q:"y=a/x —Ç“Ø—Ä—ñ–Ω–¥–µ–≥—ñ —Ñ—É–Ω–∫—Ü–∏—è ‚Äî –≥—Ä–∞—Ñ–∏–≥—ñ “õ–∞–ª–∞–π –∞—Ç–∞–ª–∞–¥—ã?", options:["–ü–∞—Ä–∞–±–æ–ª–∞","–ì–∏–ø–µ—Ä–±–æ–ª–∞","–°—ã–∑—ã“õ","–®–µ“£–±–µ—Ä"],correct:1},
    {q:"–§—É–Ω–∫—Ü–∏—è y=|x|. x<0 “Ø—à—ñ–Ω y=?", options:["0","x","‚àíx","x¬≤"],correct:2},
    {q:"y=x¬≤+3x+2. –¢”©–º–µ–Ω–≥—ñ –±–∞“ì—ã—Ç—Ç–∞–ª“ì–∞–Ω –ø–∞—Ä–∞–±–æ–ª–∞ —à–∞—Ä—Ç—ã–Ω —Ç–∞“£–¥–∞:", options:["a<0","b<0","a>0","b>0"],correct:0},
    {q:"x=0 –∫–µ–∑—ñ–Ω–¥–µ–≥—ñ y=2x+3 –º”ô–Ω—ñ?", options:["2","3","0","5"],correct:1},
    {q:"–§—É–Ω–∫—Ü–∏—è–Ω—ã“£ –µ“£ –∫—ñ—à—ñ –º”ô–Ω—ñ –¥–µ–≥–µ–Ω—ñ–º—ñ–∑...", options:["–ï“£ –∫”©–ø y","–ï“£ –∞–∑ x","–õ–∏–º–∏—Ç","y –µ“£ –∫—ñ—à—ñ –º”ô–Ω—ñ"],correct:3},
    {q:"y=‚àöx –º”ô–Ω—ñ “Ø—à—ñ–Ω x=16:", options:["2","4","8","9"],correct:1},
    {q:"y=kx+b —Ñ—É–Ω–∫—Ü–∏—è—Å—ã–Ω—ã“£ –≥—Ä–∞—Ñ–∏–≥—ñ ...", options:["–¢“Ø–∑—É (—Å—ã–∑—ã“õ)","–®–µ“£–±–µ—Ä","–ü–∞—Ä–∞–±–æ–ª–∞","–ë–µ–ª–≥—ñ—Å—ñ–∑"],correct:0}
  ];
  const testArea=document.getElementById('testArea');
  function renderTest(){
    testArea.innerHTML = '';
    testQuestions.forEach((q, idx) => {
      const div = document.createElement('div');
      div.className = 'question'; div.dataset.index = idx;
      const title = document.createElement('div');
      title.className = 'question-title';
      title.textContent = q.q;
      div.appendChild(title);
      q.options.forEach((opt, i) => {
        const id = `q${idx}_opt${i}`;
        const label = document.createElement('label');
        label.className = 'option';
        label.htmlFor = id;
        const radio = document.createElement('input');
        radio.type = 'radio';
        radio.name = `q${idx}`; radio.id = id;
        radio.value = i; label.appendChild(radio);
        label.appendChild(document.createTextNode(' '+opt));
        div.appendChild(label);
      });
      const fb = document.createElement('div');
      fb.className = 'small-feedback'; fb.id = `fb${idx}`; div.appendChild(fb);
      testArea.appendChild(div);
    });
  }
  renderTest();
  function checkTest(){
    let score=0, details=[];
    testQuestions.forEach((q, idx)=>{
      const sel=document.querySelector(`input[name="q${idx}"]:checked`);
      const fb=document.getElementById(`fb${idx}`);
      if(!sel){ fb.textContent="–ñ–∞—É–∞–ø —Ç–∞“£–¥–∞–ª–º–∞“ì–∞–Ω."; fb.className='small-feedback wrong'; details.push(`–°${idx+1}: –∂–æ“õ.`); return;}
      if(Number(sel.value)===q.correct){score++;fb.textContent="–î“±—Ä—ã—Å!";fb.className='small-feedback correct';}
      else{fb.textContent="“ö–∞—Ç–µ.";fb.className='small-feedback wrong';details.push(`–°${idx+1}: “õ–∞—Ç–µ.`);}
    });
    return {score,details};
  }
  // Match
  const matchPairs=[
    {formula:"y=kx+b",letter:"a",desc:"—Å—ã–∑—ã“õ—Ç—ã“õ —Ñ—É–Ω–∫—Ü–∏—è"},
    {formula:"y=ax¬≤+bx+c",letter:"b",desc:"–∫–≤–∞–¥—Ä–∞—Ç—Ç—ã“õ —Ñ—É–Ω–∫—Ü–∏—è"},
    {formula:"y=a/x",letter:"c",desc:"–≥–∏–ø–µ—Ä–±–æ–ª–∞ —Ñ—É–Ω–∫—Ü–∏—è—Å—ã"},
    {formula:"y=|x|",letter:"d",desc:"–º–æ–¥—É–ª—å–¥—ñ–∫ —Ñ—É–Ω–∫—Ü–∏—è"},
    {formula:"y=‚àöx",letter:"e",desc:"—Ç“Ø–±—ñ—Ä —Ñ—É–Ω–∫—Ü–∏—è—Å—ã"}
  ];
  const matchArea=document.getElementById('matchArea');
  function renderMatch(){
    const leftCol=document.createElement('div'),rightCol=document.createElement('div');
    matchPairs.forEach((item,idx)=>{
      const d=document.createElement('div');
      d.className='match-item';
      d.innerHTML=`<strong>${idx+1}) ${item.formula}</strong><br>–ñ–∞—É–∞–±—ã: <input maxlength="1" data-index="${idx}" />`;
      leftCol.appendChild(d);
    });
    const shuffled=[...matchPairs].sort(()=>Math.random()-.5);
    shuffled.forEach(item=>{
      const d=document.createElement('div');
      d.className='match-item';
      d.innerHTML=`<strong>${item.letter})</strong> ${item.desc}`;
      rightCol.appendChild(d);
    });
    matchArea.innerHTML='';matchArea.appendChild(leftCol);matchArea.appendChild(rightCol);
  }
  renderMatch();
  function checkMatch(){
    const inputs=matchArea.querySelectorAll('input[data-index]');
    let correct=0,total=matchPairs.length;
    inputs.forEach(inp=>{
      const idx=Number(inp.dataset.index);
      const val=(inp.value||'').trim().toLowerCase();
      if(val===matchPairs[idx].letter){correct++;inp.style.borderColor='var(--good)';}
      else inp.style.borderColor='var(--danger)';
    });
    return {correct,total};
  }

  // –¢–µ–∫—Å–µ—Ä—É/–°–∞“õ—Ç–∞—É
  const checkAllBtn=document.getElementById('checkAllBtn'),scoreSummaryEl=document.getElementById('scoreSummary');
  let lastScore=null;
  checkAllBtn.onclick=()=>{
    const testRes=checkTest(),matchRes=checkMatch();
    const mainScore=testRes.score,bonus=matchRes.correct*0.2,totalScore=Math.min(10,+(mainScore+bonus).toFixed(1));
    lastScore=totalScore;
    scoreSummaryEl.textContent="–ñ–∞–ª–ø—ã –±–∞–ª–ª: "+totalScore+" / 10.";
    testResult.style.display='block'; testResult.textContent=`–¢–µ—Å—Ç: ${testRes.score}/10.`;
    matchResult.style.display='block'; matchResult.textContent=`–°”ô–π–∫–µ—Å—Ç–µ–Ω–¥—ñ—Ä—É: ${matchRes.correct}/${matchRes.total}.`;
  };
  // LocalStorage –Ω”ô—Ç–∏–∂–µ
  const saveResultBtn=document.getElementById('saveResultBtn'),studentNameEl=document.getElementById('studentName'),saveMessageEl=document.getElementById('saveMessage'),resultsTableBody=document.querySelector('#resultsTable tbody'),clearResultsBtn=document.getElementById('clearResultsBtn');
  const STORAGE_KEY='mathBoard_functions_results';
  function loadResults(){const raw=localStorage.getItem(STORAGE_KEY);if(!raw)return[];try{const arr=JSON.parse(raw);return Array.isArray(arr)?arr:[];}catch(e){return[];}}
  function saveResults(arr){localStorage.setItem(STORAGE_KEY,JSON.stringify(arr));}
  function renderResultsTable(){const arr=loadResults();resultsTableBody.innerHTML='';arr.forEach((row,idx)=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${idx+1}</td><td>${row.name}</td><td>${row.score}</td><td>${row.time}</td><td>${row.remaining}</td>`;resultsTableBody.appendChild(tr);});}
  renderResultsTable();
  saveResultBtn.onclick=()=>{
    if(lastScore==null){saveMessageEl.textContent="–ê–ª–¥—ã–º–µ–Ω ‚Äú–¢–µ–∫—Å–µ—Ä—É‚Äù –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å—ã“£—ã–∑.";saveMessageEl.style.color='var(--danger)';return;}
    const name=studentNameEl.value.trim();if(!name){saveMessageEl.textContent="–ê—Ç—ã-–∂”©–Ω—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—ã“£—ã–∑.";saveMessageEl.style.color='var(--danger)';return;}
    const now=new Date(),timeStr=now.toLocaleString('kk-KZ',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'});
    const result={name,score:lastScore,time:timeStr,remaining:ftime(remaining)};
    const arr=loadResults();arr.push(result);saveResults(arr);renderResultsTable();
    saveMessageEl.textContent="–ù”ô—Ç–∏–∂–µ —Å–∞“õ—Ç–∞–ª–¥—ã.";saveMessageEl.style.color='var(--good)';
  };
  clearResultsBtn.onclick=()=>{if(confirm('–ë–∞—Ä–ª—ã“õ –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä–¥—ñ ”©—à—ñ—Ä—É–¥—ñ “õ–∞–ª–∞–π—Å—ã–∑ –±–∞?')){saveResults([]);renderResultsTable();saveMessageEl.textContent='–ë–∞—Ä–ª—ã“õ –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä ”©—à—ñ—Ä—ñ–ª–¥—ñ.';saveMessageEl.style.color='var(--muted)';}};
</script>
</body>
</html>
